#Prediction

#   来館目標日の予測

任意の会員の傾向から、次の来館日を予測する。

## 実データの分布

- 合計1731人を学習データとした。
- データ構造: `次回来館日まで日数`: `人数`
- 次回来館日が31日以上後の会員はすべて31のグループとした。

```json

{
	0: 140,
	1: 119,
 	2: 70,
	3: 69,
	4: 58,
	5: 56,
	6: 41,
	7: 37,
	8: 41,
	9: 43,
	10: 30,
	11: 26,
	12: 24,
	13: 17,
	14: 23,
	15: 10,
	16: 12,
	17: 6,
	18: 15,
	19: 11,
	20: 6,
	21: 6,
	22: 9,
	23: 13,
	24: 6,
	25: 9,
	26: 7,
	27: 3,
	28: 8,
	29: 5,
	30: 4,
	31: 807
}

```

## 説明変数

- gender (性別):  `[Male, Female]`
- age (年齢): `INTEGER`
- distance (ジムまでの距離): `FLOAT`
- 1_2 to 23_24 (時間帯別入館数の合計): `INTEGER`
- days0 to days6 (曜日別入館数の合計): `INTEGER`
- visit_count_before_N (Nヶ月前の入館数): `INTEGER`
- visit_count_week_before_N (N週前の入館数): `INTEGER`

特に、`N週前の入館数` が重要な説明変数ではないか。

## 目的変数

次の来館日は何日後か。
-> 翌週の入館数はいくつか。

翌週の入館数という目的変数を追加して検証する。
`退会日` の予測の際、限定して在籍期間の短い会員を学習データに用いたが、今回は特にそのような制限を用いず、検証する。
同条件であれば、同一条件かつアンダーサンプリング的なことをせずに、データを作成すると、たくさんのデータを収集できる。

## 予測モデル

- 線形回帰
- RNN
- LSTM

## 結果

コロナの影響を考慮して、次の説明変数を元に線形回帰を行った。
1. N週間前の入館数(0 <= N <= 8)
2. Nヶ月前の入館数(0 <= N <= 2)

なお、性別や年齢、距離、曜日別の時間帯などの説明変数を加えると、線形回帰モデルでは精度が下がった。

![[Screenshot from 2021-07-29 02-19-41.png]]


## 懸念

- 退会している会員と継続している会員を分離しなくて大丈夫か。

## イシュー

何日後に来館するか、だと予測精度がかなり低い。
翌月の来館数だと精度はX %だった。

## Link

- [[次回来館日の問題]]